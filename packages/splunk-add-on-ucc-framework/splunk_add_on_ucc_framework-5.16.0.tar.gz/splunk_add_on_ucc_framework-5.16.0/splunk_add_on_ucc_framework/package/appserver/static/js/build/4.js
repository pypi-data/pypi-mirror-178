(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{500:function(e,t,n){"use strict";n.r(t);var a=n(288),r=n.n(a),c=n(72),l=n.n(c),o=n(14),i=n.n(o),u=n(0),s=n.n(u),m=n(4),p=n(301),d=n.n(p),f=n(35),b=n.n(f),g=n(51),v=n.n(g),h=n(295),y=n.n(h),O=n(1),E=n(345),j=n.n(E),C=n(353),N=n.n(C),S=n(7),w=n(8),P=n(47),k=n(317),R=n(289),I=n(293),_=n(50),x=n(354),L=n(33),T=n.n(L),q=n(34),z=n.n(q),D=n(129),M=n.n(D),B=n(36),A=n.n(B),F=n(37),U=n.n(F),J=n(21),V=n.n(J),G=n(3),H=n.n(G),K=n(39);function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=V()(e);if(t){var r=V()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return U()(this,n)}}var W=function(e){A()(n,e);var t=Q(n);function n(e){var a;return T()(this,n),a=t.call(this,e),r()(M()(a),"setValue",(function(e){a.props.handleChange(e)})),r()(M()(a),"loadCustomMenu",(function(){return new Promise((function(e){if("external"===a.props.type)import("".concat(Object(K.a)(),"/custom/").concat(a.props.fileName,".js")).then((function(t){var n=t.default;e(n)}));else{var t=Object(P.d)().meta.name;require(["app/".concat(t,"/js/build/custom/").concat(a.props.fileName)],(function(t){return e(t)}))}}))})),a.state={loading:!0},a.shouldRender=!0,a}return z()(n,[{key:"componentDidMount",value:function(){var e=this,t=Object(P.d)();this.setState({loading:!0}),this.loadCustomMenu().then((function(n){new n(t,e.el,e.setValue).render(),e.setState({loading:!1})}))}},{key:"shouldComponentUpdate",value:function(e,t){return!(t.loading||!this.shouldRender)&&(this.shouldRender=!1,!0)}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.state.loading&&Object(S._)("Loading..."),s.a.createElement("span",{ref:function(t){e.el=t},style:{visibility:this.state.loading?"hidden":"visible"}}))}}]),n}(u.Component);W.propTypes={fileName:H.a.string.isRequired,type:H.a.string,handleChange:H.a.func};var X=W,Y=n(361),Z=n(322),$=n(362),ee=n(130),te=n.n(ee),ne=n(76),ae=n.n(ne),re=n(15),ce=n(325);function le(e){var t=e.handleRequestClose,n=e.serviceName,a=e.mode,r=e.stanzaName,c=e.formLabel,o=Object(u.useRef)(),i=Object(u.useState)(!1),m=l()(i,2),p=m[0],f=m[1],g=Object(S._)("Submit");a===I.c?g=Object(S._)("Add"):a===I.a?g=Object(S._)("Clone Input"):a===I.d&&(g=Object(S._)("Update"));var v={boxShadow:Object(re.useSplunkTheme)().embossShadow,padding:"1%",backgroundColor:"white"};return s.a.createElement(d.a,{gutter:8},s.a.createElement(d.a.Row,{style:{padding:"5px 0px"}},s.a.createElement(d.a.Column,null,s.a.createElement(k.a,null,s.a.createElement(te.a,{onClick:t},Object(S._)("Inputs"))," > ",Object(S._)(c)))),s.a.createElement(d.a.Row,null,s.a.createElement(d.a.Column,{span:2}),s.a.createElement(d.a.Column,{span:8,style:v},s.a.createElement(ce.a,{ref:o,page:_.b,serviceName:n,mode:a,stanzaName:r,handleFormSubmit:function(e,n){f(e),n&&t()}})),s.a.createElement(d.a.Column,{span:2})),s.a.createElement(d.a.Row,null,s.a.createElement(d.a.Column,{span:7}),s.a.createElement(d.a.Column,{span:3,style:{textAlign:"right"}},s.a.createElement(b.a,{appearance:"secondary",onClick:t,label:Object(S._)("Cancel"),disabled:p}),s.a.createElement(b.a,{appearance:"primary",label:p?s.a.createElement(ae.a,null):g,onClick:function(){o.current.handleSubmit()&&t()},disabled:p})),s.a.createElement(d.a.Column,{span:2})))}le.propTypes={handleRequestClose:H.a.func,serviceName:H.a.string,mode:H.a.string,stanzaName:H.a.string,formLabel:H.a.string};var oe,ie=Object(u.memo)(le),ue=n(321);function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe=Object(O.default)(d.a.Row)(oe||(oe=i()(["\n    padding: 5px 0px;\n\n    .dropdown {\n        text-align: right;\n    }\n\n    .input_button {\n        text-align: right;\n        margin-right: 0px;\n    }\n"])));t.default=function(){var e,t,n=Object(u.useState)({open:!1}),a=l()(n,2),r=a[0],c=a[1],o=Object(P.d)(),i=o.pages.inputs,p=i.services,f=i.title,g=i.description,h=i.menu,O=!!(null===(e=o.pages.inputs)||void 0===e?void 0:e.table),E=Object(u.useState)(p[0].name),C=l()(E,2),L=C[0],T=C[1],q=Object(u.useState)((null===(t=p[0])||void 0===t?void 0:t.description)||""),z=l()(q,2),D=z[0],M=z[1],B=Object(u.useState)(p[0].title),A=l()(B,2),F=A[0],U=A[1],J=s.a.createElement(b.a,{appearance:"primary",id:"addInputBtn",label:Object(S._)("Create New Input"),isMenu:!0}),V=[I.a,I.c,I.d],G=p.map((function(e){return e.name})),H=Object(m.d)(),K=Object(ue.a)();Object(u.useEffect)((function(){Q(),W()}),[H.location.search]);var Q=function(){var e=p.find((function(e){return e.name===K.get("service")}));K&&e&&V.includes(K.get("action"))&&!r.open?K.get("action")!==I.c&&r.stanzaName?c(me(me({},r),{},{open:!0,isInputPageStyle:!0,serviceName:K.get("service"),mode:K.get("action")})):c(me(me({},r),{},{open:!0,isInputPageStyle:!0,serviceName:K.get("service"),formLabel:"Create ".concat(null==e?void 0:e.title),mode:I.c})):K.get("service")&&K.get("action")||!r.open||!r.isInputPageStyle||c(me(me({},r),{},{open:!1}))},W=function(){K&&G.includes(K.get("service"))&&T(K.get("service"))},ee=function(e,t){var n=p.find((function(t){return t.name===e})).style===x.b;c(me(me({},r),{},{open:!0,serviceName:e,mode:I.c,formLabel:"Add ".concat(t),isInputPageStyle:n})),n&&(K.set("service",e),K.set("action",I.c),H.push({search:K.toString()}))},te=function(){c(me(me({},r),{},{open:!1}))},ne=function(e,t){var n,a=null===(n=p.find((function(t){return t.name===e.serviceName})))||void 0===n?void 0:n.title;c(me(me({},r),{},{open:!0,isInputPageStyle:!0,serviceName:e.serviceName,stanzaName:e.name,formLabel:t===I.a?"Clone ".concat(a):"Update ".concat(a),mode:t})),K.set("service",e.serviceName),K.set("action",t),H.push({search:K.toString()})},ae=function(){c(me(me({},r),{},{open:!1})),K.delete("service"),K.delete("action"),H.push({search:K.toString()})},re=function(e){var t=e.service;ee(t,p.find((function(e){return e.name===t})).title)},ce=Object(u.useCallback)((function(e,t){var n=t.selectedTabId;T(n);var a=p.find((function(e){return e.name===n}));a&&(M(a.description),U(a.title)),K.set("service",n),H.push({search:K.toString()})}),[L]);return s.a.createElement($.a,null,s.a.createElement(R.a,{value:null},r.isInputPageStyle&&r.open?s.a.createElement(ie,{open:r.open,handleRequestClose:ae,serviceName:r.serviceName,stanzaName:r.stanzaName,mode:r.mode,formLabel:r.formLabel}):null," ",s.a.createElement("div",{style:r.isInputPageStyle&&r.open?{display:"none"}:{display:"block"}},s.a.createElement(d.a,{gutter:8},s.a.createElement(pe,null,s.a.createElement(d.a.Column,{span:9},s.a.createElement(k.b,null,O?Object(S._)(f||""):Object(S._)(F)),s.a.createElement(k.a,null,O?Object(S._)(g||""):Object(S._)(D||""))),O?!p||null!=h&&h.src?s.a.createElement(d.a.Column,{span:3,className:"input_button"},s.a.createElement(X,{fileName:h.src,type:h.type,handleChange:re})):p.length>1?s.a.createElement(d.a.Column,{className:"dropdown",span:3},s.a.createElement(v.a,{toggle:J},s.a.createElement(y.a,{onClick:function(e){var t=p[p.findIndex((function(t){return t.title===e.target.innerText}))].name;ee(t,e.target.innerText)}},p.map((function(e){return s.a.createElement(y.a.Item,{key:e.name},e.title)}))))):s.a.createElement(d.a.Column,{span:3,className:"input_button"},s.a.createElement(b.a,{label:Object(w.a)(100),appearance:"primary",id:"addInputBtn",onClick:function(){ee(p[0].name,p[0].title)}})):null)),O?s.a.createElement(Y.a,{page:_.b,handleOpenPageStyleDialog:ne}):s.a.createElement(s.a.Fragment,null,s.a.createElement(N.a,{activeTabId:L,onChange:ce},p.map((function(e){return s.a.createElement(N.a.Tab,{key:e.name,label:Object(S._)(e.title),tabId:e.name}," ")}))),p.map((function(e){return s.a.createElement("div",{key:e.name,style:e.name!==L?{display:"none"}:{display:"block"},id:"".concat(e.name,"Tab")},s.a.createElement(Y.a,{page:_.b,serviceName:e.name,handleRequestModalOpen:function(){return ee(e.name,e.title)},handleOpenPageStyleDialog:ne}))}))),s.a.createElement(j.a,{position:"top-right"}),!r.isInputPageStyle&&r.open?s.a.createElement(Z.a,{page:_.b,open:r.open,handleRequestClose:te,serviceName:r.serviceName,mode:I.c,formLabel:r.formLabel}):null)))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi93ZWJhcHAvY29tcG9uZW50cy9DdXN0b21NZW51LmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi93ZWJhcHAvY29tcG9uZW50cy9FbnRpdHlQYWdlLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi93ZWJhcHAvcGFnZXMvSW5wdXQvSW5wdXRQYWdlLmpzeCJdLCJuYW1lcyI6WyJDdXN0b21NZW51IiwicHJvcHMiLCJuZXdWYWx1ZSIsImhhbmRsZUNoYW5nZSIsIlByb21pc2UiLCJyZXNvbHZlIiwidHlwZSIsImltcG9ydCIsImdldEJ1aWxkRGlyUGF0aCIsImZpbGVOYW1lIiwidGhlbiIsImV4dGVybmFsIiwiQ29udHJvbCIsImFwcE5hbWUiLCJnZXRVbmlmaWVkQ29uZmlncyIsIm1ldGEiLCJuYW1lIiwiX19ub25fd2VicGFja19yZXF1aXJlX18iLCJzdGF0ZSIsImxvYWRpbmciLCJzaG91bGRSZW5kZXIiLCJnbG9iYWxDb25maWciLCJ0aGlzIiwic2V0U3RhdGUiLCJsb2FkQ3VzdG9tTWVudSIsImVsIiwic2V0VmFsdWUiLCJyZW5kZXIiLCJuZXh0UHJvcHMiLCJuZXh0U3RhdGUiLCJfIiwicmVmIiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwiQ29tcG9uZW50IiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwic3RyaW5nIiwiaXNSZXF1aXJlZCIsImZ1bmMiLCJFbnRpdHlQYWdlIiwiaGFuZGxlUmVxdWVzdENsb3NlIiwic2VydmljZU5hbWUiLCJtb2RlIiwic3RhbnphTmFtZSIsImZvcm1MYWJlbCIsImZvcm0iLCJ1c2VSZWYiLCJ1c2VTdGF0ZSIsImlzU3VibWl0dGluZyIsInNldElzU3VibWl0dGluZyIsImJ1dHRvblRleHQiLCJNT0RFX0NSRUFURSIsIk1PREVfQ0xPTkUiLCJNT0RFX0VESVQiLCJjb2xTdHlsZSIsImJveFNoYWRvdyIsInVzZVNwbHVua1RoZW1lIiwiZW1ib3NzU2hhZG93IiwicGFkZGluZyIsImJhY2tncm91bmRDb2xvciIsImd1dHRlciIsIlJvdyIsIkNvbHVtbiIsIm9uQ2xpY2siLCJzcGFuIiwiQmFzZUZvcm1WaWV3IiwicGFnZSIsIlBBR0VfSU5QVVQiLCJoYW5kbGVGb3JtU3VibWl0Iiwic2V0IiwiY2xvc2UiLCJ0ZXh0QWxpZ24iLCJhcHBlYXJhbmNlIiwibGFiZWwiLCJkaXNhYmxlZCIsImN1cnJlbnQiLCJoYW5kbGVTdWJtaXQiLCJtZW1vIiwic3R5bGVkIiwiQ29sdW1uTGF5b3V0IiwiSW5wdXRQYWdlIiwib3BlbiIsImVudGl0eSIsInNldEVudGl0eSIsInVuaWZpZWRDb25maWdzIiwicGFnZXMiLCJpbnB1dHMiLCJzZXJ2aWNlcyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJjdXN0b21NZW51RmllbGQiLCJtZW51IiwiaXNPdXRlclRhYmxlIiwidGFibGUiLCJhY3RpdmVUYWJJZCIsInNldEFjdGl2ZVRhYklkIiwic2VsZWN0ZWRUYWJEZXNjcmlwdGlvbiIsInNldFNlbGVjdGVkVGFiRGVzY3JpcHRpb24iLCJzZWxlY3RlZFRhYlRpdGxlIiwic2V0U2VsZWN0ZWRUYWJUaXRsZSIsInRvZ2dsZSIsImlkIiwiaXNNZW51IiwiUEVSTUlUVEVEX01PREVTIiwicGVybWl0dGVkVGFiTmFtZXMiLCJtYXAiLCJzZXJ2aWNlIiwiaGlzdG9yeSIsInVzZUhpc3RvcnkiLCJxdWVyeSIsInVzZVF1ZXJ5IiwidXNlRWZmZWN0Iiwic2V0U2VydmljZUVudGl0eSIsInNldEFjdGl2ZVRhYiIsImxvY2F0aW9uIiwic2VhcmNoIiwiZmluZCIsIngiLCJnZXQiLCJpbmNsdWRlcyIsImlzSW5wdXRQYWdlU3R5bGUiLCJoYW5kbGVSZXF1ZXN0T3BlbiIsInNlcnZpY2VUaXRsZSIsIlNUWUxFX1BBR0UiLCJwdXNoIiwidG9TdHJpbmciLCJoYW5kbGVNb2RhbERpYWxvZ0Nsb3NlIiwiaGFuZGxlT3BlblBhZ2VTdHlsZURpYWxvZyIsInJvdyIsImhhbmRsZVBhZ2VEaWFsb2dDbG9zZSIsImhhbmRsZUNoYW5nZUN1c3RvbU1lbnUiLCJ2YWwiLCJvblRhYkNoYW5nZSIsInVzZUNhbGxiYWNrIiwiZSIsInNlbGVjdGVkVGFiSWQiLCJzZWxlY3RlZFRhYkluZm8iLCJFcnJvckJvdW5kYXJ5IiwiVGFibGVDb250ZXh0IiwidmFsdWUiLCJkaXNwbGF5Iiwic3JjIiwiY2xhc3NOYW1lIiwiUmVhY3QiLCJjcmVhdGVFbGVtZW50IiwibGVuZ3RoIiwiZXZlbnQiLCJmaW5kbmFtZSIsImZpbmRJbmRleCIsInRhcmdldCIsImlubmVyVGV4dCIsIkl0ZW0iLCJrZXkiLCJnZXRGb3JtYXR0ZWRNZXNzYWdlIiwiVGFibGVXcmFwcGVyIiwib25DaGFuZ2UiLCJUYWIiLCJ0YWJJZCIsImhhbmRsZVJlcXVlc3RNb2RhbE9wZW4iLCJwb3NpdGlvbiIsIkVudGl0eU1vZGFsIl0sIm1hcHBpbmdzIjoibTVCQU1NQSxFLGdDQUNGLFdBQVlDLEdBQU8seUJBQ2YsY0FBTUEsR0FEUyx1QkEwQlIsU0FBQ0MsR0FDUixFQUFLRCxNQUFNRSxhQUFhRCxNQTNCVCw2QkE4QkYsV0FDYixPQUFPLElBQUlFLFNBQVEsU0FBQ0MsR0FDaEIsR0FBd0IsYUFBcEIsRUFBS0osTUFBTUssS0FDWEMsT0FBQSxVQUNpQ0MsY0FEakMsbUJBRVEsRUFBS1AsTUFBTVEsU0FGbkIsUUFJRUMsTUFBSyxTQUFDQyxHQUNKLElBQU1DLEVBQVVELEVBQVEsUUFDeEJOLEVBQVFPLFVBRVQsQ0FDSCxJQUNNQyxFQURlQyxjQUNRQyxLQUFLQyxLQUNsQ0MsUUFDSSxDQUFDLE9BQUQsT0FBUUosRUFBUiw0QkFBbUMsRUFBS1osTUFBTVEsWUFDOUMsU0FBQ0csR0FBRCxPQUFhUCxFQUFRTyxhQTVDakMsRUFBS00sTUFBUSxDQUNUQyxTQUFTLEdBRWIsRUFBS0MsY0FBZSxFQUxMLEUsNkNBUW5CLFdBQW9CLFdBQ1ZDLEVBQWVQLGNBQ3JCUSxLQUFLQyxTQUFTLENBQUVKLFNBQVMsSUFDekJHLEtBQUtFLGlCQUFpQmQsTUFBSyxTQUFDRSxHQUNGLElBQUlBLEVBQVFTLEVBQWMs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LEtBQU13RSxFQUFTLEdBQUdDLFdBMENwQyxPQUtaSSxFQUNJLGtCQUFDOEQsRUFBQSxFQUFELENBQ0l4RixLQUFNQyxJQUNONEQsMEJBQTJCQSxLQUcvQixvQ0FDSSxrQkFBQyxJQUFELENBQVFqQyxZQUFhQSxFQUFhNkQsU0FBVXZCLElBQ3ZDN0MsRUFBU2tCLEtBQUksU0FBQ0MsR0FDWCxPQUFRLGtCQUFDLElBQU9rRCxJQUFSLENBQVlKLElBQUs5QyxFQUFRM0YsS0FBTTBELE1BQU81QyxZQUFFNkUsRUFBUWxCLE9BQVFxRSxNQUFPbkQsRUFBUTNGLE1BQXZFLFNBSVp3RSxFQUFTa0IsS0FBSSxTQUFDQyxHQUNWLE9BQ0kseUJBQ0k4QyxJQUFLOUMsRUFBUTNGLEtBQ2JnQixNQUNJMkUsRUFBUTNGLE9BQVMrRSxFQUFjLENBQUU4QyxRQUFTLFFBQVcsQ0FBRUEsUUFBUyxTQUVwRXZDLEdBQUUsVUFBS0ssRUFBUTNGLEtBQWIsUUFFRixrQkFBQzJJLEVBQUEsRUFBRCxDQUNJeEYsS0FBTUMsSUFDTjFCLFlBQWFpRSxFQUFRM0YsS0FDckIrSSx1QkFBd0Isa0JBQU1yQyxHQUFrQmYsRUFBUTNGLEtBQU0yRixFQUFRbEIsUUFDdEV1QywwQkFBMkJBLFVBVTNELGtCQUFDLElBQUQsQ0FBZWdDLFNBQVMsZUFDdEI3RSxFQUFPc0Msa0JBQW9CdEMsRUFBT0QsS0EzTDVDLGtCQUFDK0UsRUFBQSxFQUFELENBQ0k5RixLQUFNQyxJQUNOYyxLQUFNQyxFQUFPRCxLQUNiekMsbUJBQW9Cc0YsR0FDcEJyRixZQUFheUMsRUFBT3pDLFlBQ3BCQyxLQUFNUyxJQUNOUCxVQUFXc0MsRUFBT3RDLFlBcUxxRCIsImZpbGUiOiI0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeyBfIH0gZnJvbSAnQHNwbHVuay91aS11dGlscy9pMThuJztcbmltcG9ydCB7IGdldFVuaWZpZWRDb25maWdzIH0gZnJvbSAnLi4vdXRpbC91dGlsJztcbmltcG9ydCB7IGdldEJ1aWxkRGlyUGF0aCB9IGZyb20gJy4uL3V0aWwvc2NyaXB0JztcblxuY2xhc3MgQ3VzdG9tTWVudSBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgbG9hZGluZzogdHJ1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zaG91bGRSZW5kZXIgPSB0cnVlO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICBjb25zdCBnbG9iYWxDb25maWcgPSBnZXRVbmlmaWVkQ29uZmlncygpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgbG9hZGluZzogdHJ1ZSB9KTtcbiAgICAgICAgdGhpcy5sb2FkQ3VzdG9tTWVudSgpLnRoZW4oKENvbnRyb2wpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbUNvbnRyb2wgPSBuZXcgQ29udHJvbChnbG9iYWxDb25maWcsIHRoaXMuZWwsIHRoaXMuc2V0VmFsdWUpO1xuICAgICAgICAgICAgY3VzdG9tQ29udHJvbC5yZW5kZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBsb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGlmICghbmV4dFN0YXRlLmxvYWRpbmcgJiYgdGhpcy5zaG91bGRSZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkUmVuZGVyID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgc2V0VmFsdWUgPSAobmV3VmFsdWUpID0+IHtcbiAgICAgICAgdGhpcy5wcm9wcy5oYW5kbGVDaGFuZ2UobmV3VmFsdWUpO1xuICAgIH07XG5cbiAgICBsb2FkQ3VzdG9tTWVudSA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy50eXBlID09PSAnZXh0ZXJuYWwnKSB7XG4gICAgICAgICAgICAgICAgaW1wb3J0KFxuICAgICAgICAgICAgICAgICAgICAvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovIGAke2dldEJ1aWxkRGlyUGF0aCgpfS9jdXN0b20vJHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuZmlsZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgfS5qc2BcbiAgICAgICAgICAgICAgICApLnRoZW4oKGV4dGVybmFsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IENvbnRyb2wgPSBleHRlcm5hbC5kZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKENvbnRyb2wpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxDb25maWcgPSBnZXRVbmlmaWVkQ29uZmlncygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFwcE5hbWUgPSBnbG9iYWxDb25maWcubWV0YS5uYW1lO1xuICAgICAgICAgICAgICAgIF9fbm9uX3dlYnBhY2tfcmVxdWlyZV9fKFxuICAgICAgICAgICAgICAgICAgICBbYGFwcC8ke2FwcE5hbWV9L2pzL2J1aWxkL2N1c3RvbS8ke3RoaXMucHJvcHMuZmlsZU5hbWV9YF0sXG4gICAgICAgICAgICAgICAgICAgIChDb250cm9sKSA9PiByZXNvbHZlKENvbnRyb2wpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUubG9hZGluZyAmJiBfKCdMb2FkaW5nLi4uJyl9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXsoZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsID0gZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgdmlzaWJpbGl0eTogdGhpcy5zdGF0ZS5sb2FkaW5nID8gJ2hpZGRlbicgOiAndmlzaWJsZScgfX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbkN1c3RvbU1lbnUucHJvcFR5cGVzID0ge1xuICAgIGZpbGVOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgdHlwZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBoYW5kbGVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgQ3VzdG9tTWVudTtcbiIsImltcG9ydCBSZWFjdCwgeyBtZW1vLCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcblxuaW1wb3J0IEJ1dHRvbiBmcm9tICdAc3BsdW5rL3JlYWN0LXVpL0J1dHRvbic7XG5pbXBvcnQgTGluayBmcm9tICdAc3BsdW5rL3JlYWN0LXVpL0xpbmsnO1xuaW1wb3J0IFdhaXRTcGlubmVyIGZyb20gJ0BzcGx1bmsvcmVhY3QtdWkvV2FpdFNwaW5uZXInO1xuaW1wb3J0IENvbHVtbkxheW91dCBmcm9tICdAc3BsdW5rL3JlYWN0LXVpL0NvbHVtbkxheW91dCc7XG5pbXBvcnQgeyBfIH0gZnJvbSAnQHNwbHVuay91aS11dGlscy9pMThuJztcbmltcG9ydCB7IHVzZVNwbHVua1RoZW1lIH0gZnJvbSAnQHNwbHVuay90aGVtZXMnO1xuXG5pbXBvcnQgeyBNT0RFX0NMT05FLCBNT0RFX0NSRUFURSwgTU9ERV9FRElUIH0gZnJvbSAnLi4vY29uc3RhbnRzL21vZGVzJztcbmltcG9ydCB7IFBBR0VfSU5QVVQgfSBmcm9tICcuLi9jb25zdGFudHMvcGFnZXMnO1xuaW1wb3J0IEJhc2VGb3JtVmlldyBmcm9tICcuL0Jhc2VGb3JtVmlldyc7XG5pbXBvcnQgeyBTdWJUaXRsZUNvbXBvbmVudCB9IGZyb20gJy4uL3BhZ2VzL0lucHV0L0lucHV0UGFnZVN0eWxlJztcblxuZnVuY3Rpb24gRW50aXR5UGFnZSh7IGhhbmRsZVJlcXVlc3RDbG9zZSwgc2VydmljZU5hbWUsIG1vZGUsIHN0YW56YU5hbWUsIGZvcm1MYWJlbCB9KSB7XG4gICAgLy8gUmVmIGlzIHVzZWQgaGVyZSB0byBjYWxsIHN1Ym1pdCBtZXRob2Qgb2YgZm9ybSBvbmx5XG4gICAgY29uc3QgZm9ybSA9IHVzZVJlZigpOyAvLyBub3NlbWdyZXA6IHR5cGVzY3JpcHQucmVhY3Quc2VjdXJpdHkuYXVkaXQucmVhY3Qtbm8tcmVmcy5yZWFjdC1uby1yZWZzXG4gICAgY29uc3QgW2lzU3VibWl0dGluZywgc2V0SXNTdWJtaXR0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBsZXQgYnV0dG9uVGV4dCA9IF8oJ1N1Ym1pdCcpO1xuXG4gICAgaWYgKG1vZGUgPT09IE1PREVfQ1JFQVRFKSB7XG4gICAgICAgIGJ1dHRvblRleHQgPSBfKCdBZGQnKTtcbiAgICB9IGVsc2UgaWYgKG1vZGUgPT09IE1PREVfQ0xPTkUpIHtcbiAgICAgICAgYnV0dG9uVGV4dCA9IF8oJ0Nsb25lIElucHV0Jyk7XG4gICAgfSBlbHNlIGlmIChtb2RlID09PSBNT0RFX0VESVQpIHtcbiAgICAgICAgYnV0dG9uVGV4dCA9IF8oJ1VwZGF0ZScpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZW1ib3NzU2hhZG93IH0gPSB1c2VTcGx1bmtUaGVtZSgpO1xuICAgIGNvbnN0IGNvbFN0eWxlID0ge1xuICAgICAgICBib3hTaGFkb3c6IGVtYm9zc1NoYWRvdyxcbiAgICAgICAgcGFkZGluZzogJzElJyxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnd2hpdGUnLFxuICAgIH07XG5cbiAgICBjb25zdCBoYW5kbGVTdWJtaXQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZvcm0uY3VycmVudC5oYW5kbGVTdWJtaXQoKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgaGFuZGxlUmVxdWVzdENsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlRm9ybVN1Ym1pdCA9IChzZXQsIGNsb3NlKSA9PiB7XG4gICAgICAgIHNldElzU3VibWl0dGluZyhzZXQpO1xuICAgICAgICBpZiAoY2xvc2UpIHtcbiAgICAgICAgICAgIGhhbmRsZVJlcXVlc3RDbG9zZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gKFxuICAgICAgICA8Q29sdW1uTGF5b3V0IGd1dHRlcj17OH0+XG4gICAgICAgICAgICA8Q29sdW1uTGF5b3V0LlJvdyBzdHlsZT17eyBwYWRkaW5nOiAnNXB4IDBweCcgfX0+XG4gICAgICAgICAgICAgICAgPENvbHVtbkxheW91dC5Db2x1bW4+XG4gICAgICAgICAgICAgICAgICAgIDxTdWJUaXRsZUNvbXBvbmVudD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rIG9uQ2xpY2s9e2hhbmRsZVJlcXVlc3RDbG9zZX0+e18oJ0lucHV0cycpfTwvTGluaz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsnID4gJ31cbiAgICAgICAgICAgICAgICAgICAgICAgIHtfKGZvcm1MYWJlbCl9XG4gICAgICAgICAgICAgICAgICAgIDwvU3ViVGl0bGVDb21wb25lbnQ+XG4gICAgICAgICAgICAgICAgPC9Db2x1bW5MYXlvdXQuQ29sdW1uPlxuICAgICAgICAgICAgPC9Db2x1bW5MYXlvdXQuUm93PlxuICAgICAgICAgICAgPENvbHVtbkxheW91dC5Sb3c+XG4gICAgICAgICAgICAgICAgPENvbHVtbkxheW91dC5Db2x1bW4gc3Bhbj17Mn0gLz5cbiAgICAgICAgICAgICAgICA8Q29sdW1uTGF5b3V0LkNvbHVtbiBzcGFuPXs4fSBzdHlsZT17Y29sU3R5bGV9PlxuICAgICAgICAgICAgICAgICAgICA8QmFzZUZvcm1WaWV3IC8vIG5vc2VtZ3JlcDogdHlwZXNjcmlwdC5yZWFjdC5zZWN1cml0eS5hdWRpdC5yZWFjdC1uby1yZWZzLnJlYWN0LW5vLXJlZnNcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17Zm9ybX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U9e1BBR0VfSU5QVVR9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlTmFtZT17c2VydmljZU5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlPXttb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhbnphTmFtZT17c3RhbnphTmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUZvcm1TdWJtaXQ9e2hhbmRsZUZvcm1TdWJtaXR9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9Db2x1bW5MYXlvdXQuQ29sdW1uPlxuICAgICAgICAgICAgICAgIDxDb2x1bW5MYXlvdXQuQ29sdW1uIHNwYW49ezJ9IC8+XG4gICAgICAgICAgICA8L0NvbHVtbkxheW91dC5Sb3c+XG4gICAgICAgICAgICA8Q29sdW1uTGF5b3V0LlJvdz5cbiAgICAgICAgICAgICAgICA8Q29sdW1uTGF5b3V0LkNvbHVtbiBzcGFuPXs3fSAvPlxuICAgICAgICAgICAgICAgIDxDb2x1bW5MYXlvdXQuQ29sdW1uIHNwYW49ezN9IHN0eWxlPXt7IHRleHRBbGlnbjogJ3JpZ2h0JyB9fT5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwZWFyYW5jZT1cInNlY29uZGFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVSZXF1ZXN0Q2xvc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17XygnQ2FuY2VsJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNTdWJtaXR0aW5nfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlYXJhbmNlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17aXNTdWJtaXR0aW5nID8gPFdhaXRTcGlubmVyIC8+IDogYnV0dG9uVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVN1Ym1pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtpc1N1Ym1pdHRpbmd9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9Db2x1bW5MYXlvdXQuQ29sdW1uPlxuICAgICAgICAgICAgICAgIDxDb2x1bW5MYXlvdXQuQ29sdW1uIHNwYW49ezJ9IC8+XG4gICAgICAgICAgICA8L0NvbHVtbkxheW91dC5Sb3c+XG4gICAgICAgIDwvQ29sdW1uTGF5b3V0PlxuICAgICk7XG59XG5cbkVudGl0eVBhZ2UucHJvcFR5cGVzID0ge1xuICAgIGhhbmRsZVJlcXVlc3RDbG9zZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgc2VydmljZU5hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgbW9kZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBzdGFuemFOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGZvcm1MYWJlbDogUHJvcFR5cGVzLnN0cmluZyxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IG1lbW8oRW50aXR5UGFnZSk7XG4iLCJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VIaXN0b3J5IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5cbmltcG9ydCBDb2x1bW5MYXlvdXQgZnJvbSAnQHNwbHVuay9yZWFjdC11aS9Db2x1bW5MYXlvdXQnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdAc3BsdW5rL3JlYWN0LXVpL0J1dHRvbic7XG5pbXBvcnQgRHJvcGRvd24gZnJvbSAnQHNwbHVuay9yZWFjdC11aS9Ecm9wZG93bic7XG5pbXBvcnQgTWVudSBmcm9tICdAc3BsdW5rL3JlYWN0LXVpL01lbnUnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgVG9hc3RNZXNzYWdlcyBmcm9tICdAc3BsdW5rL3JlYWN0LXRvYXN0LW5vdGlmaWNhdGlvbnMvVG9hc3RNZXNzYWdlcyc7XG5pbXBvcnQgVGFiQmFyIGZyb20gJ0BzcGx1bmsvcmVhY3QtdWkvVGFiQmFyJztcbmltcG9ydCB7IF8gfSBmcm9tICdAc3BsdW5rL3VpLXV0aWxzL2kxOG4nO1xuaW1wb3J0IHsgZ2V0Rm9ybWF0dGVkTWVzc2FnZSB9IGZyb20gJy4uLy4uL3V0aWwvbWVzc2FnZVV0aWwnO1xuaW1wb3J0IHsgZ2V0VW5pZmllZENvbmZpZ3MgfSBmcm9tICcuLi8uLi91dGlsL3V0aWwnO1xuaW1wb3J0IHsgVGl0bGVDb21wb25lbnQsIFN1YlRpdGxlQ29tcG9uZW50IH0gZnJvbSAnLi9JbnB1dFBhZ2VTdHlsZSc7XG5pbXBvcnQgeyBUYWJsZUNvbnRleHRQcm92aWRlciB9IGZyb20gJy4uLy4uL2NvbnRleHQvVGFibGVDb250ZXh0JztcbmltcG9ydCB7IE1PREVfQ1JFQVRFLCBNT0RFX0NMT05FLCBNT0RFX0VESVQgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvbW9kZXMnO1xuaW1wb3J0IHsgUEFHRV9JTlBVVCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9wYWdlcyc7XG5pbXBvcnQgeyBTVFlMRV9QQUdFIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2RpYWxvZ1N0eWxlcyc7XG5pbXBvcnQgQ3VzdG9tTWVudSBmcm9tICcuLi8uLi9jb21wb25lbnRzL0N1c3RvbU1lbnUnO1xuaW1wb3J0IFRhYmxlV3JhcHBlciBmcm9tICcuLi8uLi9jb21wb25lbnRzL3RhYmxlL1RhYmxlV3JhcHBlcic7XG5pbXBvcnQgRW50aXR5TW9kYWwgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9FbnRpdHlNb2RhbCc7XG5pbXBvcnQgRXJyb3JCb3VuZGFyeSBmcm9tICcuLi8uLi9jb21wb25lbnRzL0Vycm9yQm91bmRhcnknO1xuaW1wb3J0IEVudGl0eVBhZ2UgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9FbnRpdHlQYWdlJztcbmltcG9ydCB1c2VRdWVyeSBmcm9tICcuLi8uLi9ob29rcy91c2VRdWVyeSc7XG5cbmNvbnN0IFJvdyA9IHN0eWxlZChDb2x1bW5MYXlvdXQuUm93KWBcbiAgICBwYWRkaW5nOiA1cHggMHB4O1xuXG4gICAgLmRyb3Bkb3duIHtcbiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gICAgfVxuXG4gICAgLmlucHV0X2J1dHRvbiB7XG4gICAgICAgIHRleHQtYWxpZ246IHJpZ2h0O1xuICAgICAgICBtYXJnaW4tcmlnaHQ6IDBweDtcbiAgICB9XG5gO1xuXG5mdW5jdGlvbiBJbnB1dFBhZ2UoKSB7XG4gICAgY29uc3QgW2VudGl0eSwgc2V0RW50aXR5XSA9IHVzZVN0YXRlKHsgb3BlbjogZmFsc2UgfSk7XG4gICAgY29uc3QgdW5pZmllZENvbmZpZ3MgPSBnZXRVbmlmaWVkQ29uZmlncygpO1xuICAgIGNvbnN0IHsgc2VydmljZXMsIHRpdGxlLCBkZXNjcmlwdGlvbiwgbWVudTogY3VzdG9tTWVudUZpZWxkIH0gPSB1bmlmaWVkQ29uZmlncy5wYWdlcy5pbnB1dHM7XG5cbiAgICAvLyBVc2VkIGZvciBvdXRlciB0YWJsZSBpcyBwcmVzZW50IG9yIG5vdFxuICAgIGNvbnN0IHRhYmxlID0gdW5pZmllZENvbmZpZ3MucGFnZXMuaW5wdXRzPy50YWJsZTtcbiAgICBjb25zdCBpc091dGVyVGFibGUgPSB0YWJsZSA/IHRydWUgOiBmYWxzZTtcblxuICAgIGNvbnN0IFthY3RpdmVUYWJJZCwgc2V0QWN0aXZlVGFiSWRdID0gdXNlU3RhdGUoc2VydmljZXNbMF0ubmFtZSk7XG4gICAgY29uc3QgW3NlbGVjdGVkVGFiRGVzY3JpcHRpb24sIHNldFNlbGVjdGVkVGFiRGVzY3JpcHRpb25dID0gdXNlU3RhdGUoc2VydmljZXNbMF0/LmRlc2NyaXB0aW9uIHx8IFwiXCIpO1xuICAgIGNvbnN0IFtzZWxlY3RlZFRhYlRpdGxlLCBzZXRTZWxlY3RlZFRhYlRpdGxlXSA9IHVzZVN0YXRlKHNlcnZpY2VzWzBdLnRpdGxlKTtcblxuICAgIGNvbnN0IHRvZ2dsZSA9IChcbiAgICAgICAgPEJ1dHRvbiBhcHBlYXJhbmNlPVwicHJpbWFyeVwiIGlkPVwiYWRkSW5wdXRCdG5cIiBsYWJlbD17XygnQ3JlYXRlIE5ldyBJbnB1dCcpfSBpc01lbnUgLz5cbiAgICApO1xuICAgIGNvbnN0IFBFUk1JVFRFRF9NT0RFUyA9IFtNT0RFX0NMT05FLCBNT0RFX0NSRUFURSwgTU9ERV9FRElUXTtcbiAgICBjb25zdCBwZXJtaXR0ZWRUYWJOYW1lcyA9IHNlcnZpY2VzLm1hcCgoc2VydmljZSkgPT4ge1xuICAgICAgICByZXR1cm4gc2VydmljZS5uYW1lO1xuICAgIH0pO1xuXG4gICAgY29uc3QgaGlzdG9yeSA9IHVzZUhpc3RvcnkoKTtcbiAgICBjb25zdCBxdWVyeSA9IHVzZVF1ZXJ5KCk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRTZXJ2aWNlRW50aXR5KCk7XG4gICAgICAgIHNldEFjdGl2ZVRhYigpO1xuICAgIH0sIFtoaXN0b3J5LmxvY2F0aW9uLnNlYXJjaF0pO1xuXG4gICAgY29uc3Qgc2V0U2VydmljZUVudGl0eSA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VydmljZSA9IHNlcnZpY2VzLmZpbmQoKHgpID0+IHgubmFtZSA9PT0gcXVlcnkuZ2V0KCdzZXJ2aWNlJykpO1xuICAgICAgICAvLyBSdW4gb25seSB3aGVuIHNlcnZpY2UgYW5kIGFjdGlvbi9tb2RlIGlzIHZhbGlkIGFuZCBtb2RhbC9wYWdlIGlzIG5vdCBvcGVuXG4gICAgICAgIGlmIChxdWVyeSAmJiBzZXJ2aWNlICYmIFBFUk1JVFRFRF9NT0RFUy5pbmNsdWRlcyhxdWVyeS5nZXQoJ2FjdGlvbicpKSAmJiAhZW50aXR5Lm9wZW4pIHtcbiAgICAgICAgICAgIC8vIHJ1biB3aGVuIG1vZGUgaXMgbm90IGNyZWF0ZSBhbmQgcHJldmlvdXMgc3RhdGUgaW5mbyBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgIGlmIChxdWVyeS5nZXQoJ2FjdGlvbicpICE9PSBNT0RFX0NSRUFURSAmJiBlbnRpdHkuc3RhbnphTmFtZSkge1xuICAgICAgICAgICAgICAgIHNldEVudGl0eSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLmVudGl0eSxcbiAgICAgICAgICAgICAgICAgICAgb3BlbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNJbnB1dFBhZ2VTdHlsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZU5hbWU6IHF1ZXJ5LmdldCgnc2VydmljZScpLFxuICAgICAgICAgICAgICAgICAgICBtb2RlOiBxdWVyeS5nZXQoJ2FjdGlvbicpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBwcmV2aW91cyBzdGF0ZSBpbmZvcm1hdGlvbiBpcyB1bmF2YWlsYWJsZSwgY3JlYXRlIG1vZGUgd2lsbCBiZSB1c2VkIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgICAgICBzZXRFbnRpdHkoe1xuICAgICAgICAgICAgICAgICAgICAuLi5lbnRpdHksXG4gICAgICAgICAgICAgICAgICAgIG9wZW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlzSW5wdXRQYWdlU3R5bGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VOYW1lOiBxdWVyeS5nZXQoJ3NlcnZpY2UnKSxcbiAgICAgICAgICAgICAgICAgICAgZm9ybUxhYmVsOiBgQ3JlYXRlICR7c2VydmljZT8udGl0bGV9YCxcbiAgICAgICAgICAgICAgICAgICAgbW9kZTogTU9ERV9DUkVBVEUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAoIXF1ZXJ5LmdldCgnc2VydmljZScpIHx8ICFxdWVyeS5nZXQoJ2FjdGlvbicpKSAmJlxuICAgICAgICAgICAgZW50aXR5Lm9wZW4gJiZcbiAgICAgICAgICAgIGVudGl0eS5pc0lucHV0UGFnZVN0eWxlXG4gICAgICAgICkge1xuICAgICAgICAgICAgLy8gQ2xvc2UgcGFnZSB3aGVuIGFueSBvZiB0aGUgcmVxdWlyZWQgcXVlcnkgcGFyYW1zIGFyZSBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgIHNldEVudGl0eSh7IC4uLmVudGl0eSwgb3BlbjogZmFsc2UgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXRBY3RpdmVUYWIgPSAoKSA9PiB7XG4gICAgICAgIGlmIChxdWVyeSAmJiBwZXJtaXR0ZWRUYWJOYW1lcy5pbmNsdWRlcyhxdWVyeS5nZXQoJ3NlcnZpY2UnKSkpIHtcbiAgICAgICAgICAgIHNldEFjdGl2ZVRhYklkKHF1ZXJ5LmdldCgnc2VydmljZScpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGdldElucHV0TWVudSA9ICgpID0+IHtcbiAgICAgICAgbGV0IGFyciA9IFtdO1xuICAgICAgICBhcnIgPSBzZXJ2aWNlcy5tYXAoKHNlcnZpY2UpID0+IHtcbiAgICAgICAgICAgIHJldHVybiA8TWVudS5JdGVtIGtleT17c2VydmljZS5uYW1lfT57c2VydmljZS50aXRsZX08L01lbnUuSXRlbT47XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXJyO1xuICAgIH07XG5cbiAgICAvLyBoYW5kbGUgbW9kYWwvcGFnZSBvcGVuIHJlcXVlc3Qgb24gY3JlYXRlL2FkZCBlbnRpdHkgYnV0dG9uXG4gICAgY29uc3QgaGFuZGxlUmVxdWVzdE9wZW4gPSAoc2VydmljZU5hbWUsIHNlcnZpY2VUaXRsZSkgPT4ge1xuICAgICAgICBjb25zdCBpc0lucHV0UGFnZVN0eWxlID0gc2VydmljZXMuZmluZCgoeCkgPT4geC5uYW1lID09PSBzZXJ2aWNlTmFtZSkuc3R5bGUgPT09IFNUWUxFX1BBR0U7XG5cbiAgICAgICAgc2V0RW50aXR5KHtcbiAgICAgICAgICAgIC4uLmVudGl0eSxcbiAgICAgICAgICAgIG9wZW46IHRydWUsXG4gICAgICAgICAgICBzZXJ2aWNlTmFtZSxcbiAgICAgICAgICAgIG1vZGU6IE1PREVfQ1JFQVRFLFxuICAgICAgICAgICAgZm9ybUxhYmVsOiBgQWRkICR7c2VydmljZVRpdGxlfWAsXG4gICAgICAgICAgICBpc0lucHV0UGFnZVN0eWxlLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGlzSW5wdXRQYWdlU3R5bGUpIHtcbiAgICAgICAgICAgIC8vIHNldCBxdWVyeSBhbmQgcHVzaCB0byBoaXN0b3J5XG4gICAgICAgICAgICBxdWVyeS5zZXQoJ3NlcnZpY2UnLCBzZXJ2aWNlTmFtZSk7XG4gICAgICAgICAgICBxdWVyeS5zZXQoJ2FjdGlvbicsIE1PREVfQ1JFQVRFKTtcbiAgICAgICAgICAgIGhpc3RvcnkucHVzaCh7IHNlYXJjaDogcXVlcnkudG9TdHJpbmcoKSB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBoYW5kbGUgY2xvc2UvY2FuY2VsL2JhY2sgcmVxdWVzdCBpbiBhZGQvY3JlYXRlIG1vZGFsIGNvbXBvbmVudFxuICAgIGNvbnN0IGhhbmRsZU1vZGFsRGlhbG9nQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgIHNldEVudGl0eSh7IC4uLmVudGl0eSwgb3BlbjogZmFsc2UgfSk7XG4gICAgfTtcblxuICAgIC8vIGdlbmVyYXRlIG1vZGFsIHN0eWxlIGRpYWxvZ1xuICAgIGNvbnN0IGdlbmVyYXRlTW9kYWxEaWFsb2cgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8RW50aXR5TW9kYWxcbiAgICAgICAgICAgICAgICBwYWdlPXtQQUdFX0lOUFVUfVxuICAgICAgICAgICAgICAgIG9wZW49e2VudGl0eS5vcGVufVxuICAgICAgICAgICAgICAgIGhhbmRsZVJlcXVlc3RDbG9zZT17aGFuZGxlTW9kYWxEaWFsb2dDbG9zZX1cbiAgICAgICAgICAgICAgICBzZXJ2aWNlTmFtZT17ZW50aXR5LnNlcnZpY2VOYW1lfVxuICAgICAgICAgICAgICAgIG1vZGU9e01PREVfQ1JFQVRFfVxuICAgICAgICAgICAgICAgIGZvcm1MYWJlbD17ZW50aXR5LmZvcm1MYWJlbH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIC8vIGhhbmRsZSBjbG9uZS9lZGl0IHJlcXVlc3QgcGVyIHJvdyBmcm9tIHRhYmxlIGZvciBwYWdlIHN0eWxlIGRpYWxvZ1xuICAgIGNvbnN0IGhhbmRsZU9wZW5QYWdlU3R5bGVEaWFsb2cgPSAocm93LCBtb2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gc2VydmljZXMuZmluZCgoeCkgPT4geC5uYW1lID09PSByb3cuc2VydmljZU5hbWUpPy50aXRsZTtcbiAgICAgICAgc2V0RW50aXR5KHtcbiAgICAgICAgICAgIC4uLmVudGl0eSxcbiAgICAgICAgICAgIG9wZW46IHRydWUsXG4gICAgICAgICAgICBpc0lucHV0UGFnZVN0eWxlOiB0cnVlLFxuICAgICAgICAgICAgc2VydmljZU5hbWU6IHJvdy5zZXJ2aWNlTmFtZSxcbiAgICAgICAgICAgIHN0YW56YU5hbWU6IHJvdy5uYW1lLFxuICAgICAgICAgICAgZm9ybUxhYmVsOiBtb2RlID09PSBNT0RFX0NMT05FID8gYENsb25lICR7bGFiZWx9YCA6IGBVcGRhdGUgJHtsYWJlbH1gLFxuICAgICAgICAgICAgbW9kZSxcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHNldCBxdWVyeSBhbmQgcHVzaCB0byBoaXN0b3J5XG4gICAgICAgIHF1ZXJ5LnNldCgnc2VydmljZScsIHJvdy5zZXJ2aWNlTmFtZSk7XG4gICAgICAgIHF1ZXJ5LnNldCgnYWN0aW9uJywgbW9kZSk7XG4gICAgICAgIGhpc3RvcnkucHVzaCh7IHNlYXJjaDogcXVlcnkudG9TdHJpbmcoKSB9KTtcbiAgICB9O1xuXG4gICAgLy8gaGFuZGxlIGNsb3NlIHJlcXVlc3QgZm9yIHBhZ2Ugc3R5bGUgZGlhbG9nXG4gICAgY29uc3QgaGFuZGxlUGFnZURpYWxvZ0Nsb3NlID0gKCkgPT4ge1xuICAgICAgICBzZXRFbnRpdHkoeyAuLi5lbnRpdHksIG9wZW46IGZhbHNlIH0pO1xuICAgICAgICBxdWVyeS5kZWxldGUoJ3NlcnZpY2UnKTtcbiAgICAgICAgcXVlcnkuZGVsZXRlKCdhY3Rpb24nKTtcbiAgICAgICAgaGlzdG9yeS5wdXNoKHsgc2VhcmNoOiBxdWVyeS50b1N0cmluZygpIH0pO1xuICAgIH07XG5cbiAgICAvLyBnZW5lcmF0ZSBwYWdlIHN0eWxlIGRpYWxvZ1xuICAgIGNvbnN0IGdlbmVyYXRlUGFnZURpYWxvZyA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxFbnRpdHlQYWdlXG4gICAgICAgICAgICAgICAgb3Blbj17ZW50aXR5Lm9wZW59XG4gICAgICAgICAgICAgICAgaGFuZGxlUmVxdWVzdENsb3NlPXtoYW5kbGVQYWdlRGlhbG9nQ2xvc2V9XG4gICAgICAgICAgICAgICAgc2VydmljZU5hbWU9e2VudGl0eS5zZXJ2aWNlTmFtZX1cbiAgICAgICAgICAgICAgICBzdGFuemFOYW1lPXtlbnRpdHkuc3RhbnphTmFtZX1cbiAgICAgICAgICAgICAgICBtb2RlPXtlbnRpdHkubW9kZX1cbiAgICAgICAgICAgICAgICBmb3JtTGFiZWw9e2VudGl0eS5mb3JtTGFiZWx9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH07XG5cbiAgICBjb25zdCBoYW5kbGVDaGFuZ2VDdXN0b21NZW51ID0gKHZhbCkgPT4ge1xuICAgICAgICBjb25zdCB7IHNlcnZpY2UgfSA9IHZhbDtcbiAgICAgICAgaGFuZGxlUmVxdWVzdE9wZW4oc2VydmljZSwgc2VydmljZXMuZmluZCgoeCkgPT4geC5uYW1lID09PSBzZXJ2aWNlKS50aXRsZSk7XG4gICAgfTtcblxuICAgIGNvbnN0IG9uVGFiQ2hhbmdlID0gdXNlQ2FsbGJhY2soKGUsIHsgc2VsZWN0ZWRUYWJJZCB9KSA9PiB7XG4gICAgICAgIHNldEFjdGl2ZVRhYklkKHNlbGVjdGVkVGFiSWQpO1xuXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGFiSW5mbyA9IHNlcnZpY2VzLmZpbmQoKHNlcnZpY2UpID0+IHNlcnZpY2UubmFtZSA9PT0gc2VsZWN0ZWRUYWJJZCk7XG4gICAgICAgIGlmIChzZWxlY3RlZFRhYkluZm8pIHtcbiAgICAgICAgICAgIHNldFNlbGVjdGVkVGFiRGVzY3JpcHRpb24oc2VsZWN0ZWRUYWJJbmZvLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHNldFNlbGVjdGVkVGFiVGl0bGUoc2VsZWN0ZWRUYWJJbmZvLnRpdGxlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHF1ZXJ5LnNldCgnc2VydmljZScsIHNlbGVjdGVkVGFiSWQpO1xuICAgICAgICBoaXN0b3J5LnB1c2goeyBzZWFyY2g6IHF1ZXJ5LnRvU3RyaW5nKCkgfSk7XG5cbiAgICB9LCBbYWN0aXZlVGFiSWRdKTtcblxuICAgIC8vIE1ha2luZyBhIGRyb3Bkb3duIGlmIHdlIGhhdmUgbW9yZSB0aGFuIG9uZSBzZXJ2aWNlXG4gICAgY29uc3QgbWFrZVNpbmdsZVNlbGVjdERyb3BEb3duID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPENvbHVtbkxheW91dC5Db2x1bW4gY2xhc3NOYW1lPVwiZHJvcGRvd25cIiBzcGFuPXszfT5cbiAgICAgICAgICAgICAgICA8RHJvcGRvd24gdG9nZ2xlPXt0b2dnbGV9PlxuICAgICAgICAgICAgICAgICAgICA8TWVudVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluZG5hbWUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlc1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VzLmZpbmRJbmRleChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoeCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeC50aXRsZSA9PT0gZXZlbnQudGFyZ2V0LmlubmVyVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlUmVxdWVzdE9wZW4oZmluZG5hbWUsIGV2ZW50LnRhcmdldC5pbm5lclRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge2dldElucHV0TWVudSgpfVxuICAgICAgICAgICAgICAgICAgICA8L01lbnU+XG4gICAgICAgICAgICAgICAgPC9Ecm9wZG93bj5cbiAgICAgICAgICAgIDwvQ29sdW1uTGF5b3V0LkNvbHVtbj5cbiAgICAgICAgKVxuICAgIH1cblxuICAgIC8vIE1ha2luZyBhIGRyb3Bkb3duIGlmIHdlIGhhdmUgb25lIHNlcnZpY2VcbiAgICBjb25zdCBtYWtlSW5wdXRCdXR0b24gPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Q29sdW1uTGF5b3V0LkNvbHVtbiBzcGFuPXszfSBjbGFzc05hbWU9XCJpbnB1dF9idXR0b25cIj5cbiAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPXtnZXRGb3JtYXR0ZWRNZXNzYWdlKDEwMCl9XG4gICAgICAgICAgICAgICAgICAgIGFwcGVhcmFuY2U9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgaWQ9XCJhZGRJbnB1dEJ0blwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVJlcXVlc3RPcGVuKHNlcnZpY2VzWzBdLm5hbWUsIHNlcnZpY2VzWzBdLnRpdGxlKTtcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9Db2x1bW5MYXlvdXQuQ29sdW1uPlxuICAgICAgICApXG4gICAgfVxuXG4gICAgLy8gTWFraW5nIGEgY3VzdG9tIG1lbnVcbiAgICBjb25zdCBtYWtlQ3VzdG9tTWVudSA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxDb2x1bW5MYXlvdXQuQ29sdW1uIHNwYW49ezN9IGNsYXNzTmFtZT1cImlucHV0X2J1dHRvblwiPlxuICAgICAgICAgICAgICAgIHtSZWFjdC5jcmVhdGVFbGVtZW50KEN1c3RvbU1lbnUsIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWU6IGN1c3RvbU1lbnVGaWVsZC5zcmMsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGN1c3RvbU1lbnVGaWVsZC50eXBlLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVDaGFuZ2U6IGhhbmRsZUNoYW5nZUN1c3RvbU1lbnVcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvQ29sdW1uTGF5b3V0LkNvbHVtbj5cbiAgICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICAgIDxFcnJvckJvdW5kYXJ5PlxuICAgICAgICAgICAgPFRhYmxlQ29udGV4dFByb3ZpZGVyIHZhbHVlPXtudWxsfT5cbiAgICAgICAgICAgICAgICB7ZW50aXR5LmlzSW5wdXRQYWdlU3R5bGUgJiYgZW50aXR5Lm9wZW4gPyBnZW5lcmF0ZVBhZ2VEaWFsb2coKSA6IG51bGx9eycgJ31cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eS5pc0lucHV0UGFnZVN0eWxlICYmIGVudGl0eS5vcGVuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB7IGRpc3BsYXk6ICdub25lJyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB7IGRpc3BsYXk6ICdibG9jaycgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8Q29sdW1uTGF5b3V0IGd1dHRlcj17OH0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Um93PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDb2x1bW5MYXlvdXQuQ29sdW1uIHNwYW49ezl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGl0bGVDb21wb25lbnQ+eyBpc091dGVyVGFibGUgPyBfKHRpdGxlIHx8IFwiXCIpIDogXyhzZWxlY3RlZFRhYlRpdGxlKSB9PC9UaXRsZUNvbXBvbmVudD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN1YlRpdGxlQ29tcG9uZW50PnsgaXNPdXRlclRhYmxlID8gXyhkZXNjcmlwdGlvbiB8fCBcIlwiKSA6ICBfKHNlbGVjdGVkVGFiRGVzY3JpcHRpb24gfHwgJycpIH08L1N1YlRpdGxlQ29tcG9uZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sdW1uTGF5b3V0LkNvbHVtbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzT3V0ZXJUYWJsZSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzZXJ2aWNlcyAmJiAhY3VzdG9tTWVudUZpZWxkPy5zcmMpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoc2VydmljZXMubGVuZ3RoID4gMSkgPyBtYWtlU2luZ2xlU2VsZWN0RHJvcERvd24oKSA6IG1ha2VJbnB1dEJ1dHRvbigpKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlQ3VzdG9tTWVudSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Sb3c+XG4gICAgICAgICAgICAgICAgICAgIDwvQ29sdW1uTGF5b3V0PlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc091dGVyVGFibGUgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRhYmxlV3JhcHBlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlPXtQQUdFX0lOUFVUfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVPcGVuUGFnZVN0eWxlRGlhbG9nPXtoYW5kbGVPcGVuUGFnZVN0eWxlRGlhbG9nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJCYXIgYWN0aXZlVGFiSWQ9e2FjdGl2ZVRhYklkfSBvbkNoYW5nZT17b25UYWJDaGFuZ2V9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3NlcnZpY2VzLm1hcCgoc2VydmljZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoPFRhYkJhci5UYWIga2V5PXtzZXJ2aWNlLm5hbWV9IGxhYmVsPXtfKHNlcnZpY2UudGl0bGUpfSB0YWJJZD17c2VydmljZS5uYW1lfT4gPC9UYWJCYXIuVGFiPilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RhYkJhcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZXMubWFwKChzZXJ2aWNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtzZXJ2aWNlLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZS5uYW1lICE9PSBhY3RpdmVUYWJJZCA/IHsgZGlzcGxheTogJ25vbmUnIH0gOiB7IGRpc3BsYXk6ICdibG9jaycgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2Ake3NlcnZpY2UubmFtZX1UYWJgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFibGVXcmFwcGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZT17UEFHRV9JTlBVVH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlTmFtZT17c2VydmljZS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVJlcXVlc3RNb2RhbE9wZW49eygpID0+IGhhbmRsZVJlcXVlc3RPcGVuKHNlcnZpY2UubmFtZSwgc2VydmljZS50aXRsZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlT3BlblBhZ2VTdHlsZURpYWxvZz17aGFuZGxlT3BlblBhZ2VTdHlsZURpYWxvZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIDxUb2FzdE1lc3NhZ2VzIHBvc2l0aW9uPVwidG9wLXJpZ2h0XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgeyFlbnRpdHkuaXNJbnB1dFBhZ2VTdHlsZSAmJiBlbnRpdHkub3BlbiA/IGdlbmVyYXRlTW9kYWxEaWFsb2coKSA6IG51bGx9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L1RhYmxlQ29udGV4dFByb3ZpZGVyPlxuICAgICAgICA8L0Vycm9yQm91bmRhcnk+XG4gICAgKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgSW5wdXRQYWdlO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==
[tox]
minversion = 3.18
skipsdist = true
envlist =
    d{32,41}-py{39,310}
    isort
    black
    flake8

skip_missing_interpreters = true

markers =
    functional: mark a test as functional

[testenv]
setenv =
    PYTHONPATH=tests/demo

deps:
    py39: pytest<7
    py10: pytest>=7
    d32: Django==3.2.*
    d41: Django==4.1.*

extras = dev,full

commands =
    pip install .[test]
    {posargs:pytest tests --create-db}

[testenv:flake8]
basepython = python3
usedevelop = false
deps = flake8 >= 3.7.0
changedir = {toxinidir}
commands = flake8 src

[testenv:black]
basepython = python3
usedevelop = false
deps = black
changedir = {toxinidir}
commands = black --check --diff src

[testenv:isort]
basepython = python3
usedevelop = false
deps = isort >= 5.1.0
changedir = {toxinidir}
commands = isort --check-only --diff src tests

[testenv:check-manifest]
basepython = python3
usedevelop = false
deps = check-manifest
changedir = {toxinidir}
commands = check-manifest


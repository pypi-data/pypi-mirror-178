[sphinx]
# This preset exemplifies how to extend with subpackages, here for sphinx docs generation.
# Note that usually the sphinx docs generation files and config are not available in the
# source distribution of a python package. This requires you to bundle a cvs source tarball
# instead.

# Used after %package and the like, could be -n python-{name}-doc
docs-name = doc

docs-dir = docs
docs-build-req = BuildRequires: python%{{python3_version}}dist(sphinx)
docs-description = {long-description}
docs-license-file = {license-file}

docs-build =
	PYTHONPATH="$$PWD" sphinx-build ${docs-dir} html
	rm -rf html/.{{doctrees,buildinfo}}

docs-files =
	%files ${docs-name}
	%doc html
	%license ${docs-license-file}


# Now override some sections to append our new code
preamble =
	${base:preamble}
	${docs-build-req}

description =
	${base:description}

	%package ${docs-name}
	Summary: Documentation for {name}

	%description ${docs-name}
	${docs-description}

build =
	${base:build}
	${docs-build}

files =
	${base:files}
	${docs-files}

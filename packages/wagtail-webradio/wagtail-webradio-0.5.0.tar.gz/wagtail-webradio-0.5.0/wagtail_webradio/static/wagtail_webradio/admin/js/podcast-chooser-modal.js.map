{"version":3,"file":"podcast-chooser-modal.js","sources":["../../../../static_src/admin/js/podcast-chooser-modal.js"],"sourcesContent":["import $ from 'jquery';\n\nwindow.PODCAST_CHOOSER_MODAL_ONLOAD_HANDLERS = {\n  choose(modal) {\n    function serializeFormData(form) {\n      // Return the non-empty form data as an object\n      return Object.fromEntries(\n        Array.from(new FormData(form)).filter((pair) => Boolean(pair[1]))\n      );\n    }\n\n    const searchForm = modal.body[0].querySelector('form.podcast-search');\n    const searchResults = modal.body[0].querySelector('#search-results');\n    const searchUrl = searchForm.action;\n    let request;\n\n    function ajaxifyLinks(context) {\n      $('.listing a', context).on('click', function () {\n        modal.loadUrl(this.href);\n        return false;\n      });\n\n      $('.pagination a', context).on('click', function () {\n        loadResults(this.href);\n        return false;\n      });\n    }\n\n    function loadResults(url, data) {\n      const opts = {\n        url,\n        success(resultsData) {\n          request = null;\n          $(searchResults).html(resultsData);\n          ajaxifyLinks(searchResults);\n        },\n        error() {\n          request = null;\n        },\n      };\n      if (data) {\n        opts.data = data;\n      }\n\n      request = $.ajax(opts);\n    }\n\n    function search() {\n      loadResults(searchUrl, serializeFormData(searchForm));\n      return false;\n    }\n\n    $(searchForm).on('submit', search);\n\n    $(searchForm.elements).on('input', function () {\n      if (request) {\n        request.abort();\n      }\n\n      clearTimeout($.data(this, 'timer'));\n      const wait = setTimeout(search, 200);\n      $(this).data('timer', wait);\n    });\n\n    ajaxifyLinks(modal.body);\n  },\n  chosen(modal, jsonData) {\n    modal.respond('podcastChosen', jsonData.result);\n    modal.close();\n  },\n};\n"],"names":["window","PODCAST_CHOOSER_MODAL_ONLOAD_HANDLERS","choose","modal","request","searchForm","body","querySelector","searchResults","searchUrl","action","ajaxifyLinks","context","$","on","loadUrl","this","href","loadResults","url","data","opts","success","resultsData","html","error","ajax","search","form","Object","fromEntries","Array","from","FormData","filter","pair","Boolean","elements","abort","clearTimeout","wait","setTimeout","chosen","jsonData","respond","result","close"],"mappings":"6GAEAA,OAAOC,sCAAwC,CAC7CC,gBAAOC,OAWDC,EAHEC,EAAaF,EAAMG,KAAK,GAAGC,cAAc,uBACzCC,EAAgBL,EAAMG,KAAK,GAAGC,cAAc,mBAC5CE,EAAYJ,EAAWK,gBAGpBC,EAAaC,GACpBC,UAAE,aAAcD,GAASE,GAAG,SAAS,kBACnCX,EAAMY,QAAQC,KAAKC,OACZ,KAGTJ,UAAE,gBAAiBD,GAASE,GAAG,SAAS,kBACtCI,EAAYF,KAAKC,OACV,cAIFC,EAAYC,EAAKC,OAClBC,EAAO,CACXF,IAAAA,EACAG,iBAAQC,GACNnB,EAAU,KACVS,UAAEL,GAAegB,KAAKD,GACtBZ,EAAaH,IAEfiB,iBACErB,EAAU,OAGVgB,IACFC,EAAKD,KAAOA,GAGdhB,EAAUS,UAAEa,KAAKL,YAGVM,QA3CkBC,SA4CzBV,EAAYT,GA5CamB,EA4CgBvB,EA1ClCwB,OAAOC,YACZC,MAAMC,KAAK,IAAIC,SAASL,IAAOM,QAAO,SAACC,UAASC,QAAQD,EAAK,WA0CxD,EAGTtB,UAAER,GAAYS,GAAG,SAAUa,GAE3Bd,UAAER,EAAWgC,UAAUvB,GAAG,SAAS,WAC7BV,GACFA,EAAQkC,QAGVC,aAAa1B,UAAEO,KAAKJ,KAAM,cACpBwB,EAAOC,WAAWd,EAAQ,KAChCd,UAAEG,MAAMI,KAAK,QAASoB,MAGxB7B,EAAaR,EAAMG,OAErBoC,gBAAOvC,EAAOwC,GACZxC,EAAMyC,QAAQ,gBAAiBD,EAASE,QACxC1C,EAAM2C"}